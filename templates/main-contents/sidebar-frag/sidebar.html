<!--sidebar-frag-->
<aside class="sidebar" th:fragment="sidebar" role="complementary" aria-label="사이드바 메뉴">
    <!-- 인기 게임 순위 -->
    <section class="popular-games-section sidebar-section" aria-labelledby="popular-games-title">
        <div class="section-header">
            <h3 class="section-title" id="popular-games-title">
                <span class="title-icon" aria-hidden="true">🏆</span>
                인기 게임 순위
            </h3>
            <a href="/games?sort=popular" class="section-link" aria-label="인기 게임 전체 순위 보기">
                더보기
            </a>
        </div>
        <div class="games-ranking" role="region" aria-label="인기 게임 순위 목록">
            <ol class="ranking-list" th:if="${not #lists.isEmpty(popularGames)}">
                <li class="ranking-item" th:each="game, iterStat : ${popularGames}" role="listitem">
                    <div class="ranking-content">
                        <span class="ranking-number" th:text="${iterStat.count}" aria-label="순위">1</span>
                        <div class="game-info">
                            <a class="game-link"
                               th:href="@{/games/{id}(id=${game.id})}"
                               th:text="${game.title}"
                               th:aria-label="${iterStat.count} + '위 ' + ${game.title} + ' 게임 보기'">게임 제목</a>
                            <div class="game-stats" th:if="${game.playCount}">
                                <span class="play-count" th:text="${game.playCount + '회 플레이'}">플레이 횟수</span>
                            </div>
                        </div>
                        <div class="ranking-badge" th:if="${iterStat.count <= 3}" aria-hidden="true">
                            <span class="badge-icon"
                                  th:classappend="${iterStat.count == 1 ? 'gold' : (iterStat.count == 2 ? 'silver' : 'bronze')}">
                                ★
                            </span>
                        </div>
                    </div>
                </li>
            </ol>
            <!-- 빈 상태 -->
            <div class="empty-state" th:if="${#lists.isEmpty(popularGames)}" role="status">
                <div class="empty-icon" aria-hidden="true">🎮</div>
                <p class="empty-text">인기 게임이 없습니다</p>
            </div>
        </div>
    </section>

    <!-- 최근 업로드 게임 -->
    <section class="recent-games-section sidebar-section" aria-labelledby="recent-games-title">
        <div class="section-header">
            <h3 class="section-title" id="recent-games-title">
                <span class="title-icon" aria-hidden="true">🆕</span>
                최근 업로드 게임
            </h3>
            <a href="/games?sort=newest" class="section-link" aria-label="최근 업로드 게임 전체 보기">
                더보기
            </a>
        </div>
        <div class="recent-games-list" role="region" aria-label="최근 업로드 게임 목록">
            <ul class="game-items" th:if="${not #lists.isEmpty(recentGames)}">
                <li class="game-item" th:each="game : ${recentGames}" role="listitem">
                    <div class="game-card">
                        <div class="game-info">
                            <h4 class="game-title">
                                <a class="game-link"
                                   th:href="@{/games/{id}(id=${game.id})}"
                                   th:text="${game.title}"
                                   th:aria-label="${game.title} + ' 게임 보기'">게임 제목</a>
                            </h4>
                            <div class="game-meta">
                                <time class="upload-date"
                                      th:datetime="${game.uploadDate}"
                                      th:text="${#temporals.format(game.uploadDate, 'yyyy-MM-dd')}">업로드 날짜</time>
                            </div>
                        </div>
                        <span class="new-indicator" aria-label="신규">NEW</span>
                    </div>
                </li>
            </ul>
            <!-- 빈 상태 -->
            <div class="empty-state" th:if="${#lists.isEmpty(recentGames)}" role="status">
                <div class="empty-icon" aria-hidden="true">📁</div>
                <p class="empty-text">최근 업로드된 게임이 없습니다</p>
            </div>
        </div>
    </section>

    <!-- 공지사항 요약 -->
    <section class="notice-section sidebar-section" aria-labelledby="notice-title">
        <div class="section-header">
            <h3 class="section-title" id="notice-title">
                <span class="title-icon" aria-hidden="true">📢</span>
                공지사항
            </h3>
            <a href="/board/notice" class="section-link" aria-label="공지사항 전체 보기">
                더보기
            </a>
        </div>
        <div class="notice-list" role="region" aria-label="공지사항 목록">
            <ul class="notice-items" th:if="${not #lists.isEmpty(notices)}">
                <li class="notice-item" th:each="notice : ${notices}" role="listitem">
                    <div class="notice-card">
                        <span class="notice-badge" aria-label="공지">공지</span>
                        <h4 class="notice-title">
                            <a class="notice-link"
                               th:href="@{/board/notice/{id}(id=${notice.id})}"
                               th:text="${notice.title}"
                               th:aria-label="${notice.title} + ' 공지사항 보기'">공지 제목</a>
                        </h4>
                        <div class="notice-meta">
                            <time class="notice-date"
                                  th:datetime="${notice.createdAt}"
                                  th:text="${#temporals.format(notice.createdAt, 'MM-dd')}">작성일</time>
                        </div>
                    </div>
                </li>
            </ul>
            <!-- 빈 상태 -->
            <div class="empty-state" th:if="${#lists.isEmpty(notices)}" role="status">
                <div class="empty-icon" aria-hidden="true">📋</div>
                <p class="empty-text">공지사항이 없습니다</p>
            </div>
        </div>
    </section>

    <!-- 이벤트 배너 -->
    <section class="event-banner-section sidebar-section" aria-labelledby="event-title">
        <div class="section-header">
            <h3 class="section-title" id="event-title">
                <span class="title-icon" aria-hidden="true">🎉</span>
                이벤트
            </h3>
            <a href="/events" class="section-link" aria-label="이벤트 전체 보기">
                더보기
            </a>
        </div>
        <div class="event-list" role="region" aria-label="이벤트 목록">
            <div class="event-items" th:if="${not #lists.isEmpty(events)}">
                <div class="event-item" th:each="event : ${events}" role="article">
                    <div class="event-card">
                        <div class="event-image" th:if="${event.bannerImage}" aria-hidden="true">
                            <img th:src="${event.bannerImage}"
                                 alt=""
                                 class="banner-img"
                                 onerror="this.src='/static/images/default-event.png'">
                        </div>
                        <div class="event-content">
                            <h4 class="event-title">
                                <a th:href="@{/events/{id}(id=${event.id})}"
                                   th:text="${event.title}"
                                   th:aria-label="${event.title} + ' 이벤트 보기'">이벤트 제목</a>
                            </h4>
                            <p class="event-description" th:text="${event.description}">이벤트 설명</p>
                            <div class="event-meta">
                                <span class="event-period" th:if="${event.startDate and event.endDate}">
                                    <time th:datetime="${event.startDate}"
                                          th:text="${#temporals.format(event.startDate, 'MM.dd')}">시작일</time>
                                    ~
                                    <time th:datetime="${event.endDate}"
                                          th:text="${#temporals.format(event.endDate, 'MM.dd')}">종료일</time>
                                </span>
                                <span class="event-status active" th:if="${event.isActive}">진행중</span>
                                <span class="event-status ended" th:unless="${event.isActive}">종료</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 빈 상태 -->
            <div class="empty-state" th:if="${#lists.isEmpty(events)}" role="status">
                <div class="empty-icon" aria-hidden="true">🎪</div>
                <p class="empty-text">진행 중인 이벤트가 없습니다</p>
            </div>
        </div>
    </section>

    <!-- 사이드바 푸터 (간단한 링크들) -->
    <section class="sidebar-footer">
        <div class="quick-links">
            <a href="/help" class="quick-link" aria-label="도움말 페이지로 이동">
                <span class="link-icon" aria-hidden="true">❓</span>
                도움말
            </a>
            <a href="/contact" class="quick-link" aria-label="문의하기 페이지로 이동">
                <span class="link-icon" aria-hidden="true">✉️</span>
                문의하기
            </a>
            <a href="/feedback" class="quick-link" aria-label="피드백 보내기 페이지로 이동">
                <span class="link-icon" aria-hidden="true">💭</span>
                피드백
            </a>
        </div>
    </section>
</aside>